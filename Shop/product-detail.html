<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Product Details</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 30px;
      background-color: #f2f2f2;
    }
    .product-detail {
      background: white;
      padding: 20px;
      border-radius: 10px;
      max-width: 600px;
      margin: auto;
      box-shadow: 0 0 10px rgba(0,0,0,0.2);
    }
    .product-detail img {
      max-width: 100%;
      height: auto;
      border-radius: 10px;
    }
    .product-info {
      margin-top: 20px;
    }
    .product-info h2 {
      margin-bottom: 10px;
    }
    .back-button {
      display: inline-block;
      margin-top: 20px;
      text-decoration: none;
      background-color: #007bff;
      color: white;
      padding: 10px 15px;
      border-radius: 5px;
    }
  </style>
</head>
<body>

  <!-- ✅ 1. Recommendations section - हे img tag नंतर किंवा खाली कुठेही टाक -->
<h3 style="margin-top: 40px;">Recommended Products</h3>
<div id="recommended-products" class="row"></div>


  <div class="product-detail">
    <img id="productImage" src="" alt="Product Image" />
    <div class="product-info">
      <h2 id="productName">Loading...</h2>
      <p id="productPrice"></p>
      <p id="productDescription"></p>
    </div>
    <a href="index.html" class="back-button">← Back to Products</a>
  </div>

  <script>
    // Get values from URL
    const params = new URLSearchParams(window.location.search);
    const name = params.get("name");
    const price = params.get("price");
    const image = params.get("image");
    const description = params.get("desc") || "Traditional Outfit";

    // Show values in HTML
    document.getElementById("productName").textContent = name;
    document.getElementById("productPrice").textContent = "Price: ₹" + price;
    document.getElementById("productImage").src = image;
    document.getElementById("productDescription").textContent = description;
  </script>

  <div id="product360" class="text-center">
  <img id="viewer" src="" width="400" />
  <div class="mt-3">
    <button onclick="showPrev()" class="btn btn-secondary">⟨ Prev</button>
    <button onclick="showNext()" class="btn btn-secondary">Next ⟩</button>
  </div>
</div>


<script>
  const urlParams = new URLSearchParams(window.location.search);
  const images = urlParams.get('image'); // e.g. images/clothing1.jpg

  if (image) {
    const baseName = image.substring(image.lastIndexOf('/') + 1, image.lastIndexOf('.')); // clothing1
    const ext = image.substring(image.lastIndexOf('.') + 1); // jpg
    const total = 8;
    let current = 1;
    
    document.getElementById('viewer').src = `images/${baseName}_${current}.${ext}`;

    function updateViewer() {
      document.getElementById('viewer').src = `images/${baseName}_${current}.${ext}`;
    }

    function showNext() {
      current = current === total ? 1 : current + 1;
      updateViewer();
    }

    function showPrev() {
      current = current === 1 ? total : current - 1;
      updateViewer();
    }

    updateViewer(); // initial load
    window.showNext = showNext;
    window.showPrev = showPrev;
  }
</script>

<!-- ✅ 2. Recommendation system JS - हे शेवटच्या <script> नंतर टाक -->
<script>
  const productName = document.getElementById("productName").textContent.trim();

  fetch(`/api/recommend?name=${encodeURIComponent(productName)}`)
    .then(res => res.json())
    .then(recommendedNames => {
      const container = document.getElementById("recommended-products");
      container.innerHTML = ''; // Clear previous content
      recommendedNames.forEach(name => {
        const div = document.createElement('div');
        div.className = 'col-md-3';
        div.style = 'padding: 10px; background: white; margin: 10px; border-radius: 5px; box-shadow: 0 0 5px rgba(0,0,0,0.2);';
        div.innerHTML = `<p style="text-align: center;">${name}</p>`;
        container.appendChild(div);
      });
    })
    .catch(err => console.error('Error loading recommendations:', err));
</script>

</body>
</html>
